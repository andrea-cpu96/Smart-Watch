/*
 * sd.c
 *
 *  Created on: Jun 6, 2024
 *      Author: Fato
 */

#include "main.h"
#include "sd.h"

uint32_t file_error = 0;
sd_detection_error = 0;
FATFS SDFatFs;  			// File system object for SD card logical drive
char SDPath[4]; 			// SD card logical drive path
FIL MJPEG_File;          	// MJPEG File object
char fileName[] = "segment_000.avi";


void sd_init(void)
{

	if(FATFS_LinkDriver(&SD_Driver, SDPath) == 0)
	{

		// Init the SD Card
		BSP_SD_Init(0);

	    // Register the file system object to the FatFs module
	    if(f_mount(&SDFatFs, (TCHAR const*)SDPath, 0) == FR_OK)
	    {


	      }

	    }
	    else
	    {
	      sd_detection_error = 1;
	    }

	    if((file_error != 0) || (sd_detection_error != 0))
	    {
	      LCD_FileErrorDisplay();
	    }
	  }


}



/*##-6- Open the MJPEG avi file with read access #######################*/
if(f_open(&MJPEG_File, fileName, FA_READ) == FR_OK)
{

		/*Close the avi file*/
		f_close(&MJPEG_File);


}

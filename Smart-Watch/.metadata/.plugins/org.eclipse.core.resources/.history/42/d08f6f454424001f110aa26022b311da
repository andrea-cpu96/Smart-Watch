/*
 * sd.c
 *
 *  Created on: Jun 6, 2024
 *      Author: Fato
 */

#include "main.h"
#include "sd.h"


FATFS SDFatFs;  			// File system object for SD card logical drive
char SDPath[4]; 			// SD card logical drive path
FIL MJPEG_File;          	// MJPEG File object
char fileName[] = "image.avi";


static void sd_error_handler(void);


void sd_init(void)
{

	if(FATFS_LinkDriver(&SD_Driver, SDPath) == 0)
	{

		// Init the SD Card
		BSP_SD_Init(0);

	    // Register the file system object to the FatFs module
	    if(f_mount(&SDFatFs, (TCHAR const*)SDPath, 0) != FR_OK)
	    	sd_error_handler();

	}

}


void sd_open(FIL *file, char *fileName, char rw)
{

	if(f_open(file, fileName, FA_READ) != FR_OK)
		sd_error_handler();

}




static void sd_error_handler(void)
{

	while(1);

}
